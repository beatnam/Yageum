<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
	<meta charset="UTF-8">
	<title>ë‚´ì—­ ìƒì„¸ë³´ê¸°</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link
		href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Brush+Script&family=Black+Han+Sans&display=swap"
		rel="stylesheet">

	<link rel="stylesheet" href="../css/common.css">
	<link rel="stylesheet" href="../css/cashbook_detail.css">

</head>

<body>
	<!-- í—¤ë” -->
	<div th:replace="fragments/header :: header"></div>

	<!-- ì‚¬ì´ë“œë°” + ë³¸ë¬¸ -->
	<div class="app-container">
		<div th:replace="fragments/sidebar :: sidebar"></div>
		<main class="content">
			<div class="content-header">
				<h2>ë‚´ì—­ ìƒì„¸ë³´ê¸°</h2>
				<p>ìì„¸í•œ ë‚´ì—­ì„ í™•ì¸í•˜ì„¸ìš”!</p>
			</div>
			<div class="content-body">
				<div class="transaction-detail-box">
					<!-- ê¸ˆì•¡ ë° ì•„ì´ì½˜ -->
					<div class="transaction-amount">
					    <div class="transaction-icon" th:text="${expense.expenseType} ? 'ğŸ’¸' : 'ğŸ’°'">ğŸ’°</div>
					    <span class="amount"
					          th:classappend="${expense.expenseType} ? ' expense' : ' income'"
					          th:text="${expense.expenseType ? '-' : '+'} + #numbers.formatInteger(expense.expenseSum, 3, 'COMMA')">
					    </span>
					</div>

					<!-- ê±°ë˜ ì •ë³´ -->
					<table class="transaction-info">
					    <tr>
					        <td><strong>ë‚ ì§œ</strong></td>
					        <td class="right" th:text="${#temporals.format(expense.expenseDate, 'yyyyë…„ MMì›” ddì¼')}">2025ë…„ 06ì›” 15ì¼</td>
					    </tr>
					    <tr>
					        <td><strong>ìœ í˜•</strong></td>
					        <td class="right" th:text="${expense.expenseType ? 'ì§€ì¶œ' : 'ìˆ˜ì…'}">ìˆ˜ì…</td>
					    </tr>
					    <tr>
					        <td><strong>ë‚´ìš©</strong></td>
					        <td class="right" th:text="${expense.expenseContent}">ì•„ì´í…œ ë‚´ìš©</td>
					    </tr>
					    <tr>
					        <td><strong>ìˆ˜ë‹¨</strong></td>
					        <td class="right"
					            th:text="${expense.methodType == 'ì¹´ë“œ' ? expense.cardName : (expense.methodType == 'ê³„ì¢Œì´ì²´' ? expense.bankName + ' ' + expense.accountName : 'í˜„ê¸ˆ')}">
					        </td>
					    </tr>
					    <tr>
					        <td><strong>ì¹´í…Œê³ ë¦¬</strong></td>
					        <td class="right" th:text="${expense.cmName + ' / ' + expense.csName}">ì¹´í…Œê³ ë¦¬</td>
					    </tr>
					</table>

					<!-- ë©”ëª¨ -->
					<div class="memo-section">
					    <label for="memo">ë©”ëª¨</label><br>
					    <textarea id="memo" name="memo" rows="3" th:text="${expense.expenseMemo}"></textarea>
					</div>

					<!-- ë²„íŠ¼ -->
					<div class="btn-section">
						<button type="button" class="btn-edit">ìˆ˜ì •í•˜ê¸°</button>
					</div>
				</div>
			</div>
			<!-- ê°€ê³„ë¶€ ì¶”ê°€ ë²„íŠ¼ -->
			<div class="floating-label">ê°€ê³„ë¶€ ì¶”ê°€</div>
				<a href="/cashbook/insert" class="floating-btn">+</a>
            </div>
		</main>
	</div>

	<!--	í‘¸í„°-->
	<div th:replace="fragments/footer :: footer"></div>

	<script>
		function getDateFromURL() {
				const params = new URLSearchParams(window.location.search);
				return params.get("date");
			}

		function formatDateToKorean(dateStr) {
			const [year, month, day] = dateStr.split("-");
			return `${year}ë…„ ${parseInt(month)}ì›” ${parseInt(day)}ì¼`;
			}

		document.addEventListener("DOMContentLoaded", function () {
					const dateStr = getDateFromURL();
					if (dateStr) {
						const koreanDate = formatDateToKorean(dateStr);
						const dateCell = document.getElementById("transactionDate");
						if (dateCell) {
							dateCell.textContent = koreanDate;
						}
					}
				});

		
		
		//ìˆ˜ì •í•˜ê¸° ë²„íŠ¼ ëˆ„ë¥´ë©´ ìˆ˜ì • í˜ì´ì§€ë¡œ ë„˜ì–´ê°
		document.querySelector(".btn-edit").addEventListener("click", function () {
		    const params = new URLSearchParams(window.location.search);
		    const id = params.get("id");
		    const date = params.get("date");
		    window.location.href = `/cashbook/update?id=${id}&date=${date}`;
		});
		
		


		function logout() {
			if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
				window.location.href = '/logout';
			}
		}

		function previousDay() {
			// ì´ì „ ë‚ ì§œë¡œ ì´ë™í•˜ëŠ” ë¡œì§
			console.log('ì´ì „ ë‚ ì§œë¡œ ì´ë™');
		}

		function nextDay() {
			// ë‹¤ìŒ ë‚ ì§œë¡œ ì´ë™í•˜ëŠ” ë¡œì§
			console.log('ë‹¤ìŒ ë‚ ì§œë¡œ ì´ë™');
		}
	</script>
</body>

</html>