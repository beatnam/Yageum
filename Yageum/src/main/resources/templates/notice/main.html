<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìë™ ê³µì§€ì‚¬í•­ íŒì—…</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Black+Han+Sans&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="../css/notice_main.css" >
	<link rel="icon" href="../img/gold.png" type="image/x-icon">
  </head>
<body>
    <!-- íŒì—… ì˜¤ë²„ë ˆì´ -->
    <div class="popup-overlay" id="noticePopup">
        <div class="popup-container">
            <!-- íŒì—… í—¤ë” -->
            <div class="popup-header">
                <h2 class="popup-title">ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
                <button class="popup-close" onclick="closePopup()">&times;</button>
            </div>

            <!-- íŒì—… ë³¸ë¬¸ -->
            <div class="popup-body">
                <div class="notice-list">
					<div th:each="notice, state : ${notice}">
	                    <div class="notice-item" th:onclick="viewNotice([[${notice.noticeIn}]])">
	                        <div class="notice-header">
	                            <span class="notice-number" th:text="${state.count}"></span>
	                            <span class="notice-date" th:text="${notice.noticeDate}"></span>
	                        </div>
	                        <div class="notice-title" th:text="${notice.noticeSubject}">
<!--	                            <span class="notice-badge important">ì¤‘ìš”</span>-->
	                        </div>
	                    </div>
					</div>
                  
                    </div>
                </div>

            <!-- íŒì—… í•˜ë‹¨ -->
            <div class="popup-footer">
                <button class="btn-today-close" onclick="closeTodayPopup()">ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°</button>
                <button class="btn-close" onclick="closePopup()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <script>
		//ì¿ í‚¤ get / set í•¨ìˆ˜ 
		function setCookie(name, value, expirationDate) {
	           let expires = "";
	           if (expirationDate) {
	               expires = "; expires=" + expirationDate.toUTCString();
	           }
	           document.cookie = name + "=" + (value || "") + expires + "; path=/";
	       }

	       function getCookie(name) {
	           let nameEQ = name + "=";
	           let ca = document.cookie.split(';');
	           for(let i=0; i < ca.length; i++) {
	               let c = ca[i];
	               while (c.charAt(0) === ' ') c = c.substring(1, c.length);
	               if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
	           }
	           return null;
	       }
        // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ìœ¼ë¡œ íŒì—… í‘œì‹œ
        window.addEventListener('load', function() {
            // ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°ë¥¼ ì„ íƒí–ˆëŠ”ì§€ í™•ì¸
            const todayClose = sessionStorage.getItem('noticePopupTodayClose');
            const today = new Date().toDateString();
            
            if (todayClose !== today) {
                showPopup();
            }
        });

        // íŒì—… í‘œì‹œ
        function showPopup() {
            document.getElementById('noticePopup').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // íŒì—… ë‹«ê¸°
        function closePopup() {
            window.close();
        }

        // ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°
        function closeTodayPopup() {
			//alert("í´ë¦­");
			const cookieName = "hideLoginPopupToday";
			const now = new Date();
			const midnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0); 
            setCookie(cookieName, 'true', midnight);
			window.close();
           
        }

        // ì˜¤ë²„ë ˆì´ í´ë¦­ì‹œ íŒì—… ë‹«ê¸°
        document.getElementById('noticePopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closePopup();
            }
        });

        // ESC í‚¤ë¡œ íŒì—… ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePopup();
            }
        });

        // ê³µì§€ì‚¬í•­ ìƒì„¸ë³´ê¸°
        function viewNotice(noticeIn) {
            alert('ê³µì§€ì‚¬í•­ ' + noticeIn + 'ë²ˆ ìƒì„¸ë³´ê¸°ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
			location.href="/notice/content?noticeIn=" + noticeIn;
			
        }
		/*
		window.onload = function() {
		    // íŒì—…ì°½ì˜ body ìš”ì†Œ í¬ê¸°ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.
		    // ìŠ¤í¬ë¡¤ ì˜ì—­ì„ í¬í•¨í•œ ì‹¤ì œ ì½˜í…ì¸  í¬ê¸°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
		    var bodyWidth = document.body.scrollWidth;
		    var bodyHeight = document.body.scrollHeight;

		    // ë¶€ëª¨ ì°½ìœ¼ë¡œ í¬ê¸° ì •ë³´ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
		    // window.openerëŠ” íŒì—…ì„ ì—° ë¶€ëª¨ ì°½ì„ ì°¸ì¡°í•©ë‹ˆë‹¤.
		    if (window.opener) {
		        // postMessageë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€ëª¨ ì°½ì— ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
		        // ì²« ë²ˆì§¸ ì¸ìëŠ” ë³´ë‚¼ ë°ì´í„° ê°ì²´, ë‘ ë²ˆì§¸ ì¸ìëŠ” ëŒ€ìƒ origin (ë³´ì•ˆìƒ ì¤‘ìš”)
		        window.opener.postMessage({
		            type: 'resizePopup', // ë©”ì‹œì§€ íƒ€ì… (ë¶€ëª¨ê°€ ì‹ë³„í•˜ê¸° ìœ„í•¨)
		            width: bodyWidth,
		            height: bodyHeight
		        }, 'http://localhost:8080/cashbook/main'); // ì¤‘ìš”: ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” '*' ëŒ€ì‹  ë¶€ëª¨ í˜ì´ì§€ì˜ ì •í™•í•œ origin (ì˜ˆ: 'http://localhost:8080' ë˜ëŠ” 'https://yourdomain.com')ì„ ë„£ì–´ ë³´ì•ˆì„ ê°•í™”í•´ì•¼ í•©ë‹ˆë‹¤.
		    }
		};
		
		*/
		
		
    </script>
</body>
</html>