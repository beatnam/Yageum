<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ê²°ì œ ìˆ˜ë‹¨ ì¶”ê°€</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gowun+Dodum&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="../css/my_page.css">
	<link rel="stylesheet" href="../css/my_page_method_insert.css">
</head>

<body>
	<!-- í—¤ë” -->
	<div th:replace="fragments/header :: header"></div>

	<div class="accountbook-container">
		<nav class="accountbook-sidebar">
			<h2>ë©”ë‰´</h2>
			<ul class="accountbook-sidebar-menu">
				<li><a href="#overview" class="active">ğŸ  ìì‚° í˜„í™©</a></li>
				<li><a href="#transactions">ğŸ“ ê±°ë˜ ë‚´ì—­</a></li>
				<li><a href="#statistics">ğŸ“Š í†µê³„ ë° ë¶„ì„</a></li>
				<li><a href="#">âš™ï¸ ì„¤ì •</a></li>
				<li><a href="#">â“ ë„ì›€ë§</a></li>
			</ul>
		</nav>

		<main class="accountbook-main-content">
			<h1>ë‚´ ì¹´ë“œ ì¶”ê°€</h1>
			
			<div class="card-form-container">
				<form id="cardAddForm">
					<!-- ì¹´ë“œë²ˆí˜¸ -->
					<div class="form-group">
						<label class="form-label required">ì¹´ë“œë²ˆí˜¸</label>
						<div class="card-number-group">
							<input type="text" class="form-input card-number-input" id="card1" maxlength="4" placeholder="1234">
							<input type="text" class="form-input card-number-input masked" id="card2" maxlength="4" placeholder="â€¢â€¢â€¢â€¢">
							<input type="text" class="form-input card-number-input masked" id="card3" maxlength="4" placeholder="â€¢â€¢â€¢â€¢">
							<input type="text" class="form-input card-number-input" id="card4" maxlength="4" placeholder="1234">
						</div>
						<div class="error-message" id="cardNumberError"></div>
					</div>

					<!-- ìœ íš¨ê¸°ê°„ -->
					<div class="form-group">
						<label class="form-label required">ìœ íš¨ê¸°ê°„</label>
						<div class="expiry-group">
							<input type="text" class="form-input expiry-input" id="expiryMM" maxlength="2" placeholder="MM">
							<span class="expiry-slash">/</span>
							<input type="text" class="form-input expiry-input" id="expiryYY" maxlength="2" placeholder="YY">
						</div>
						<div class="error-message" id="expiryError"></div>
					</div>

					<!-- ì†Œìœ ìëª… -->
					<div class="form-group">
						<label class="form-label required">ì†Œìœ ìëª…</label>
						<input type="text" class="form-input" id="cardHolder" placeholder="ì¹´ë“œ ì†Œìœ ì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
						<div class="error-message" id="cardHolderError"></div>
					</div>

					<!-- ë³´ì•ˆì½”ë“œ(CVC) -->
					<div class="form-group">
						<label class="form-label required">ë³´ì•ˆì½”ë“œ(CVC)</label>
						<div class="cvc-group">
							<input type="text" class="form-input cvc-input" id="cvc" maxlength="3" placeholder="â€¢â€¢â€¢">
							<span class="cvc-hint">* 3ê¸€ìë§Œ ì…ë ¥í•˜ì„¸ìš”</span>
						</div>
						<div class="error-message" id="cvcError"></div>
					</div>

					<!-- ì¹´ë“œì´ë¦„ -->
					<div class="form-group">
						<label class="form-label required">ì¹´ë“œì´ë¦„</label>
						<input type="text" class="form-input" id="cardName" placeholder="ì˜ˆ: ì‚¼ì„±ì¹´ë“œ, ì‹ í•œì¹´ë“œ ë“±">
						<div class="error-message" id="cardNameError"></div>
					</div>

					<!-- ì¹´ë“œë³„ì¹­ -->
					<div class="form-group">
						<label class="form-label">ì¹´ë“œë³„ì¹­</label>
						<input type="text" class="form-input" id="cardAlias" placeholder="ê°œì¸ì ìœ¼ë¡œ ì‚¬ìš©í•  ë³„ì¹­ (ì„ íƒì‚¬í•­)">
					</div>

					<!-- ì €ì¥ ë²„íŠ¼ -->
					<button type="submit" class="save-button">ì €ì¥í•˜ê¸°</button>
				</form>
			</div>
		</main>
	</div>

	<!-- í‘¸í„° -->
	<div th:replace="fragments/footer :: footer"></div>

<script>
			// ì¹´ë“œ ì¶”ê°€ í¼ ìœ íš¨ì„± ê²€ì‚¬ ë° ê¸°ëŠ¥ (ìƒˆë¡œ ì¶”ê°€ëœ JavaScript)
		document.addEventListener('DOMContentLoaded', function() {
			const form = document.getElementById('cardAddForm');
			const cardInputs = document.querySelectorAll('.card-number-input');
			const expiryInputs = document.querySelectorAll('.expiry-input');
			
			// ì¹´ë“œë²ˆí˜¸ ì…ë ¥ ì‹œ ìë™ í¬ì»¤ìŠ¤ ì´ë™
			cardInputs.forEach((input, index) => {
				input.addEventListener('input', function(e) {
					// ìˆ«ìë§Œ ì…ë ¥ í—ˆìš©
					this.value = this.value.replace(/[^0-9]/g, '');
					
					// 4ìë¦¬ ì…ë ¥ ì‹œ ë‹¤ìŒ í•„ë“œë¡œ ìë™ ì´ë™
					if (this.value.length === 4 && index < cardInputs.length - 1) {
						cardInputs[index + 1].focus();
					}
				});

				// ë°±ìŠ¤í˜ì´ìŠ¤ í‚¤ ì²˜ë¦¬
				input.addEventListener('keydown', function(e) {
					if (e.key === 'Backspace' && this.value.length === 0 && index > 0) {
						cardInputs[index - 1].focus();
					}
				});
			});

			// ìœ íš¨ê¸°ê°„ ì…ë ¥ ì²˜ë¦¬
			expiryInputs.forEach((input, index) => {
				input.addEventListener('input', function(e) {
					this.value = this.value.replace(/[^0-9]/g, '');
					
					if (this.value.length === 2 && index === 0) {
						expiryInputs[1].focus();
					}
				});

				input.addEventListener('keydown', function(e) {
					if (e.key === 'Backspace' && this.value.length === 0 && index === 1) {
						expiryInputs[0].focus();
					}
				});
			});

			// CVC ì…ë ¥ ì²˜ë¦¬ (ìˆ«ìë§Œ)
			document.getElementById('cvc').addEventListener('input', function(e) {
				this.value = this.value.replace(/[^0-9]/g, '');
			});

			// í¼ ì œì¶œ ì²˜ë¦¬
			form.addEventListener('submit', function(e) {
				e.preventDefault();
				
				if (validateForm()) {
					// í¼ ë°ì´í„° ìˆ˜ì§‘
					const formData = {
						cardNumber: Array.from(cardInputs).map(input => input.value).join(''),
						expiryMonth: document.getElementById('expiryMM').value,
						expiryYear: document.getElementById('expiryYY').value,
						cardHolder: document.getElementById('cardHolder').value,
						cvc: document.getElementById('cvc').value,
						cardName: document.getElementById('cardName').value,
						cardAlias: document.getElementById('cardAlias').value
					};
					
					console.log('ì¹´ë“œ ì •ë³´:', formData);
					alert('ì¹´ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
					
					// ê²°ì œ ìˆ˜ë‹¨ í˜ì´ì§€ë¡œ ì´ë™ (ì‹¤ì œë¡œëŠ” í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ êµ¬í˜„)
					// window.location.href = '/payment-methods';
				}
			});

			// í¼ ìœ íš¨ì„± ê²€ì‚¬
			function validateForm() {
				let isValid = true;
				
				// ì¹´ë“œë²ˆí˜¸ ê²€ì‚¬
				const cardNumber = Array.from(cardInputs).map(input => input.value).join('');
				if (cardNumber.length !== 16) {
					showError('cardNumberError', 'ì¹´ë“œë²ˆí˜¸ 16ìë¦¬ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
					cardInputs.forEach(input => input.classList.add('error'));
					isValid = false;
				} else {
					hideError('cardNumberError');
					cardInputs.forEach(input => input.classList.remove('error'));
				}

				// ìœ íš¨ê¸°ê°„ ê²€ì‚¬
				const month = document.getElementById('expiryMM').value;
				const year = document.getElementById('expiryYY').value;
				if (!month || !year || month < 1 || month > 12) {
					showError('expiryError', 'ì˜¬ë°”ë¥¸ ìœ íš¨ê¸°ê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
					expiryInputs.forEach(input => input.classList.add('error'));
					isValid = false;
				} else {
					hideError('expiryError');
					expiryInputs.forEach(input => input.classList.remove('error'));
				}

				// ì†Œìœ ìëª… ê²€ì‚¬
				const cardHolder = document.getElementById('cardHolder').value.trim();
				if (!cardHolder) {
					showError('cardHolderError', 'ì†Œìœ ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
					document.getElementById('cardHolder').classList.add('error');
					isValid = false;
				} else {
					hideError('cardHolderError');
					document.getElementById('cardHolder').classList.remove('error');
				}

				// CVC ê²€ì‚¬
				const cvc = document.getElementById('cvc').value;
				if (cvc.length !== 3) {
					showError('cvcError', 'ë³´ì•ˆì½”ë“œ 3ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
					document.getElementById('cvc').classList.add('error');
					isValid = false;
				} else {
					hideError('cvcError');
					document.getElementById('cvc').classList.remove('error');
				}

				// ì¹´ë“œì´ë¦„ ê²€ì‚¬
				const cardName = document.getElementById('cardName').value.trim();
				if (!cardName) {
					showError('cardNameError', 'ì¹´ë“œì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
					document.getElementById('cardName').classList.add('error');
					isValid = false;
				} else {
					hideError('cardNameError');
					document.getElementById('cardName').classList.remove('error');
				}

				return isValid;
			}

			// ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
			function showError(elementId, message) {
				document.getElementById(elementId).textContent = message;
			}

			// ì—ëŸ¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
			function hideError(elementId) {
				document.getElementById(elementId).textContent = '';
			}
		});
	</script>
</body>

</html>