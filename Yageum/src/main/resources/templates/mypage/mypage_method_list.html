<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ê³„ì¢Œ ë° ê²°ì œ ìˆ˜ë‹¨ ê´€ë¦¬</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gowun+Dodum&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="../css/my_page.css">
	<link rel="stylesheet" href="../css/my_page_method.css">
</head>

<body>
	<!-- í—¤ë” -->
	<div th:replace="fragments/header :: header"></div>

	<div class="accountbook-container">
		<div th:replace="fragments/m_sidebar :: m_sidebar"></div>

		<main class="accountbook-main-content">
			<h1>ê²°ì œ ìˆ˜ë‹¨ ê´€ë¦¬</h1>

			<!-- ê³„ì¢Œ ì„¹ì…˜ -->
			<section class="payment-section" data-section="account">
				<div class="section-header">
					<h2 class="section-title">ğŸ’° ê³„ì¢Œ & í˜„ê¸ˆ</h2>
					<div class="section-controls">
						<button class="btn btn-edit">í¸ì§‘</button>
						<button class="btn btn-add">ì¶”ê°€</button>
<!--						<button class="btn btn-use" style="display: none;">ì‚¬ìš©</button>-->
						<button class="btn btn-delete" style="display: none;">ì‚­ì œ</button>
						<button class="btn btn-cancel" style="display: none;">ì·¨ì†Œ</button>
					</div>
				</div>
				<ul class="payment-list">
					<li class="payment-item" th:each="account : ${accountList}">
						<div class="checkbox-container">
							<input type="checkbox" class="select-checkbox">
							<div class="payment-info">
								<div class="payment-name" th:text="${account.accountName}">í†µì¥ì´ë¦„</div>
								<div class="payment-details"
									th:text="${account.bankName + ' â€¢ ' + account.accountNum}">ì€í–‰ â€¢ ê³„ì¢Œë²ˆí˜¸</div>
							</div>
						</div>
<!--						<span class="payment-status status-active">ì‚¬ìš©ì¤‘</span>-->
					</li>
				</ul>
			</section>

			<!-- ì‹ ìš©ì¹´ë“œ ì„¹ì…˜ -->
			<section class="payment-section" data-section="credit">
				<div class="section-header">
					<h2 class="section-title">ğŸ’³ ì‹ ìš©ì¹´ë“œ</h2>
					<div class="section-controls">
						<button class="btn btn-edit">í¸ì§‘</button>
						<button class="btn btn-add">ì¶”ê°€</button>
<!--						<button class="btn btn-use" style="display: none;">ì‚¬ìš©</button>-->
						<button class="btn btn-delete" style="display: none;">ì‚­ì œ</button>
						<button class="btn btn-cancel" style="display: none;">ì·¨ì†Œ</button>
					</div>
				</div>
				<ul class="payment-list">
					<li class="payment-item" th:each="card : ${cardList}" th:if="${card.methodIn == 1}">
						<div class="checkbox-container">
							<input type="checkbox" class="select-checkbox">
							<div class="payment-info">
								<div class="payment-name" th:text="${card.cardName}">ì¹´ë“œì´ë¦„</div>
								<div class="payment-details"
								     th:text="${card.cardCompany.ccName + ' â€¢ ' + card.cardNum}">íšŒì‚¬ â€¢ ì¹´ë“œë²ˆí˜¸</div>
							</div>
						</div>
<!--						<span class="payment-status status-active">ì‚¬ìš©ì¤‘</span>-->
					</li>
				</ul>
			</section>

			<!-- ì²´í¬ì¹´ë“œ ì„¹ì…˜ -->
			<section class="payment-section" data-section="debit">
				<div class="section-header">
					<h2 class="section-title">ğŸ’´ ì²´í¬ì¹´ë“œ</h2>
					<div class="section-controls">
						<button class="btn btn-edit">í¸ì§‘</button>
						<button class="btn btn-add">ì¶”ê°€</button>
<!--						<button class="btn btn-use" style="display: none;">ì‚¬ìš©</button>-->
						<button class="btn btn-delete" style="display: none;">ì‚­ì œ</button>
						<button class="btn btn-cancel" style="display: none;">ì·¨ì†Œ</button>
					</div>
				</div>
				<ul class="payment-list">
					<li class="payment-item" th:each="card : ${cardList}" th:if="${card.methodIn == 2}">
						<div class="checkbox-container">
							<input type="checkbox" class="select-checkbox">
							<div class="payment-info">
								<div class="payment-name" th:text="${card.cardName}">ì¹´ë“œì´ë¦„</div>
								<div class="payment-details"
								     th:text="${card.cardCompany.ccName + ' â€¢ ' + card.cardNum}">íšŒì‚¬ â€¢ ì¹´ë“œë²ˆí˜¸</div>
							</div>
						</div>
<!--						<span class="payment-status status-active">ì‚¬ìš©ì¤‘</span>-->
					</li>
				</ul>
			</section>
		</main>
	</div>

	<!-- í‘¸í„° -->
	<div th:replace="fragments/footer :: footer"></div>

<script>
		// í¸ì§‘ ëª¨ë“œ í† ê¸€ ê¸°ëŠ¥ (ìƒˆë¡œ ì¶”ê°€ëœ JavaScript)
		document.addEventListener('DOMContentLoaded', function() {
			const sections = document.querySelectorAll('.payment-section');
			
			sections.forEach(section => {
				const editBtn = section.querySelector('.btn-edit');
				const deleteBtn = section.querySelector('.btn-delete');
				const addBtn = section.querySelector('.btn-add');
				//const useBtn = section.querySelector('.btn-use');
				const cancelBtn = section.querySelector('.btn-cancel');
				const checkboxes = section.querySelectorAll('.select-checkbox');

				// í¸ì§‘ ë²„íŠ¼ í´ë¦­ ì‹œ - í¸ì§‘ ëª¨ë“œ í™œì„±í™”
				editBtn.addEventListener('click', function () {
					section.classList.add('edit-mode');
					editBtn.style.display = 'none';
					addBtn.style.display = 'none';
					//useBtn.style.display = 'inline-block';
					deleteBtn.style.display = 'inline-block';
					cancelBtn.style.display = 'inline-block';
					
					// ëª¨ë“  ì²´í¬ë°•ìŠ¤ í•´ì œ
					checkboxes.forEach(checkbox => {
						checkbox.checked = false;
					});
				});
				
				// ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì‹œ - í¸ì§‘ ëª¨ë“œ ë¹„í™œì„±í™”
				cancelBtn.addEventListener('click', function() {
					section.classList.remove('edit-mode');
					editBtn.style.display = 'inline-block';
					addBtn.style.display = 'inline-block';
					//useBtn.style.display = 'none';
					deleteBtn.style.display = 'none';
					cancelBtn.style.display = 'none';
					
					// ëª¨ë“  ì²´í¬ë°•ìŠ¤ í•´ì œ
					checkboxes.forEach(checkbox => {
						checkbox.checked = false;
					});
				});
				
				// ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ
				addBtn.addEventListener('click', function() {
					window.location.href = '/mypage/minsert';
				});
				
				// ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ - í¸ì§‘ ëª¨ë“œì—ì„œë§Œ ì‘ë™
				deleteBtn.addEventListener('click', function() {
					const checkedBoxes = section.querySelectorAll('.select-checkbox:checked');
					if (checkedBoxes.length === 0) {
						alert('ì‚­ì œí•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
						return;
					}
					
					if (confirm(`ì„ íƒí•œ ${checkedBoxes.length}ê°œì˜ ê²°ì œ ìˆ˜ë‹¨ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
						checkedBoxes.forEach(checkbox => {
							checkbox.closest('.payment-item').remove();
						});
						
						// ì‚­ì œ í›„ í¸ì§‘ ëª¨ë“œ ìœ ì§€
						alert('ì„ íƒí•œ ê²°ì œ ìˆ˜ë‹¨ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
					}
				});
			//useBtn.addEventListener('click', function () {
			//	const checked = section.querySelectorAll('.select-checkbox:checked');
			//	if (checked.length === 0) {
			//		alert('ë³€ê²½í•  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
			//		return;
			//	}
			//	checked.forEach(cb => {
			//		const status = cb.closest('.payment-item').querySelector('.payment-status');
			//		if (status.classList.contains('status-active')) {
			//			status.textContent = 'ë¯¸ì‚¬ìš©';
			//			status.classList.replace('status-active', 'status-inactive');
			//		} else {
			//			status.textContent = 'ì‚¬ìš©ì¤‘';
			//			status.classList.replace('status-inactive', 'status-active');
			//		}
			//	});
			//	alert('ì„ íƒí•œ í•­ëª©ì˜ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
		//	});
		});
	});
	</script>
</body>

</html>