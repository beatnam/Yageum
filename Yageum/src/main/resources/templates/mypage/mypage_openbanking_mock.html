<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>모의 오픈뱅킹 인증</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gowun+Dodum&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="/css/my_page.css">
	<link rel="stylesheet" href="/css/my_page_mock.css">

</head>
<body>
    <div class="accountbook-container">
        <main class="accountbook-main-content">
            <h1>모의 오픈뱅킹 인증</h1>
            <p>다음 정보에 동의하십니까?</p>
            <ul>
                <li>이름: <span th:text="${session.memberName}">사용자 이름</span></li>
                <li>계좌 정보 조회</li>
            </ul>

            <button type="button" onclick="submitMockAuth()">확인</button>
        </main>
    </div>
	<script>
		function submitMockAuth() {
		    alert("인증이 완료되었습니다.");
		    
		    // 1) 모의 인증 토큰 생성
		    const token = "mock_access_token_1234";

		    // 2) 부모창에 access_token 전달
		    window.opener.sessionStorage.setItem('access_token', token);

		    // 3) 부모창에서 저장된 토큰으로 fetchAccounts 다시 요청하게 하기
		    window.opener.postMessage({ type: 'MOCK_AUTH_SUCCESS' }, '*');

		    // 4) 팝업 닫기
		    window.close();
		}
	</script>
</body>
</html>